package p79068.crypto.hash;

import java.util.Arrays;

import org.junit.Test;


public final class ShaTest {
	
	private static String msg0 = "";
	private static String msg1 = "a";
	private static String msg2 = "abc";
	private static String msg3 = "message digest";
	private static String msg4 = "abcdefghijklmnopqrstuvwxyz";
	private static String msg5 = "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq";
	private static String msg6 = "abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu";
	private static String msg7 = getMillionAs();
	
	
	
	@Test
	public void testSha1() {
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg0, "DA39A3EE5E6B4B0D3255BFEF95601890AFD80709");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg1, "86F7E437FAA5A7FCE15D1DDCB9EAEAEA377667B8");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg2, "A9993E364706816ABA3E25717850C26C9CD0D89D");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg3, "C12252CEDA8BE8994D5FA0290A47231C1D16AAE3");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg4, "32D10C7B8CF96570CA04CE37F2A19D84240D3A89");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg5, "84983E441C3BD26EBAAE4AA1F95129E5E54670F1");
		HashUtils.testAscii(Sha.SHA1_FUNCTION, msg7, "34AA973CD4C4DAA4F61EEB2BDBAD27316534016F");
	}
	
	
	@Test
	public void testSha256() {
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg0, "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg1, "CA978112CA1BBDCAFAC231B39A23DC4DA786EFF8147C4E72B9807785AFEE48BB");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg2, "BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg3, "F7846F55CF23E14EEBEAB5B4E1550CAD5B509E3348FBC4EFA3A1413D393CB650");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg4, "71C480DF93D6AE2F1EFAD1447C66C9525E316218CF51FC8D9ED832F2DAF18B73");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg5, "248D6A61D20638B8E5C026930C3E6039A33CE45964FF2167F6ECEDD419DB06C1");
		HashUtils.testAscii(Sha.SHA256_FUNCTION, msg7, "CDC76E5C9914FB9281A1C7E284D73E67F1809A48A497200E046D39CCC7112CD0");
	}
	
	
	@Test
	public void testSha512() {
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg0, "CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg1, "1F40FC92DA241694750979EE6CF582F2D5D7D28E18335DE05ABC54D0560E0F5302860C652BF08D560252AA5E74210546F369FBBBCE8C12CFC7957B2652FE9A75");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg2, "DDAF35A193617ABACC417349AE20413112E6FA4E89A97EA20A9EEEE64B55D39A2192992A274FC1A836BA3C23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg3, "107DBF389D9E9F71A3A95F6C055B9251BC5268C2BE16D6C13492EA45B0199F3309E16455AB1E96118E8A905D5597B72038DDB372A89826046DE66687BB420E7C");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg4, "4DBFF86CC2CA1BAE1E16468A05CB9881C97F1753BCE3619034898FAA1AABE429955A1BF8EC483D7421FE3C1646613A59ED5441FB0F321389F77F48A879C7B1F1");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg6, "8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7FA17299AEADB6889018501D289E4900F7E4331B99DEC4B5433AC7D329EEB6DD26545E96E55B874BE909");
		HashUtils.testAscii(Sha.SHA512_FUNCTION, msg7, "E718483D0CE769644E2E42C7BC15B4638E1F98B13B2044285632A803AFA973EBDE0FF244877EA60A4CB0432CE577C31BEB009C5C2C49AA2E4EADB217AD8CC09B");
	}
	
	
	@Test
	public void testZeroize() {
		HashUtils.testZeroization(Sha.SHA1_FUNCTION);
		HashUtils.testZeroization(Sha.SHA256_FUNCTION);
		HashUtils.testZeroization(Sha.SHA512_FUNCTION);
	}
	
	
	
	private static String getMillionAs() {
		char[] result = new char[1000000];
		Arrays.fill(result, 'a');
		return new String(result);
	}
	
}
